<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji-æ­£åˆ™åŒ¹é…</title>
    <link rel="stylesheet" href="https://c1312.netlify.app/typo.css">
    <link rel="stylesheet" href="https://c1312.netlify.app/style.css">
</head>
<body>
<header>
  <h1>Emoji-æ­£åˆ™åŒ¹é…</h1>
</header>
<main class="typo"><article><header><h1>Emoji æ­£åˆ™åŒ¹é…</h1><div><span>2024-05-09</span></div></header><div><h2>Contents</h2><div><nav><ul><li><a href=#headline-1>å‰è¨€</a><li><a href=#headline-2>TL;DR</a><li><a href=#headline-3>è§£å†³è¿‡ç¨‹</a><li><a href=#headline-4>Unicode character class escpae</a><li><a href=#headline-5>String &amp; Unicode</a><li><a href=#headline-6>ä¸ºä»€ä¹ˆ /(\ud83c[\udf00-\udfff]â€¦/u çš„æ­£åˆ™æ— æ³•åŒ¹é…ğŸ‰</a><li><a href=#headline-7>String ä¸­çš„ç›¸å…³æ–¹æ³•</a><li><a href=#headline-8>æ³¨æ„ç‚¹</a><ul><li><a href=#headline-9>å­—ç¬¦ä¸²é•¿åº¦</a><li><a href=#headline-10>Lone surrogates</a></ul><li><a href=#headline-11>Refs</a></ul></nav></div></div><div><div><h2>å‰è¨€</h2><div><p>è¦æ±‚è¾“å…¥æ¡†èƒ½è¾“å…¥é™¤äº†ç‰¹æ®Šè¡¨æƒ…å¤–çš„ä»»æ„å­—ç¬¦ã€‚<p>æˆ‘çš„ç†è§£å°±æ˜¯å°† Emoji æ’é™¤æ‰ï¼Œé€šè¿‡ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp>RegExp</a> åŒ¹é… Emoji åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç‰¹æ®Šè¡¨æƒ…ã€‚</div></div><div><h2>TL;DR</h2><div><p>å¦‚æœä½ åªæ˜¯æƒ³è¦ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…è¡¨æƒ…çš„æ­£åˆ™ï¼Œä¸‹é¢è¿™ä¸ªåº”è¯¥å°±æ»¡è¶³ğŸ‘‡ï¼š<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
</code></pre><td><pre class=chroma><code class=language-typescript>    /\p{Extended_Pictographic}/gu.test(&#34;ä½ å¥½hello123ğŸ˜„hiğŸŒ·456ğŸ‰&#34;) // true
    /\p{Extended_Pictographic}/gu.test(&#34;ä½ å¥½hello123&#34;) // false</code></pre></table></div></div></div><p><a href=https://taxodium.ink/post/emoji-regexp/regexp101-emoji-corret.png><img src=https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/c4baa5f6.png></a></div></div><div><h2>è§£å†³è¿‡ç¨‹</h2><div><p>å¯¹äº Emoji è¿™ç§æ­£åˆ™ï¼Œä¸€å¼€å§‹æƒ³ä¸åˆ°å¦‚ä½•æ„å»ºï¼Œç†è®ºä¸Šå®ƒä¹Ÿæ˜¯å±äº Stringï¼Œå¤§è‡´çŸ¥é“ Emoji å’Œ Unicode ç›¸å…³ï¼Œä½†æ€ä¹ˆç”¨æ­£åˆ™æè¿°å®ƒå‘¢ï¼Ÿ<p>æ‰€ä»¥æˆ‘çš„ç¬¬ä¸€æ­¥æ˜¯ Googleï¼Œå¾—åˆ°ä¸€ä¸ªè¿™æ ·çš„æ­£åˆ™ï¼š<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
</code></pre><td><pre class=chroma><code class=language-typescript>    /(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f\ude80-\udeff])|[\u2600-\u2B55]/</code></pre></table></div></div></div><p>æ‹¿å» <a href=https://regex101.com/>regex101</a> æµ‹è¯•äº†ä¸€ä¸‹ï¼Œè™½ç„¶èƒ½åŒ¹é…åˆ°ä¸€äº› Emojiï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰éƒ¨åˆ† Emoji åŒ¹é…ä¸åˆ°ã€‚<p><a href=https://taxodium.ink/post/emoji-regexp/regexp101-emoji-wrong.png><img src=https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/6a9013b6.png></a><p>ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼åº”è¯¥æ˜¯è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª Unicode èŒƒå›´ï¼Œéƒ¨åˆ† Emoji (ğŸ‰)æ²¡åŒ¹é…ä¸Šï¼Œè¯´æ˜è¿™ä¸ªèŒƒå›´å°äº†ï¼Œæ²¡æœ‰å›Šæ‹¬æ‰€æœ‰çš„ Emojiã€‚<p>é‚£ä¹ˆ Emoji çš„ Unicode èŒƒå›´æ˜¯å¤šå°‘ï¼Ÿæ˜¯ä¸æ˜¯ç©·ä¸¾å°±è¡Œäº†ï¼Ÿ<p>å…¶å®æ²¡åŠæ³•ç”¨ä¸€ä¸ªå›ºå®šçš„èŒƒå›´å»è¡¨è¾¾ï¼Œå› ä¸º Emoji æ˜¯æŒç»­å¢åŠ çš„ï¼Œæ¯å¢åŠ ä¸€ä¸ª Emoji å°±å¢åŠ ä¸€ä¸ªå¯¹åº”çš„ Unicode ï¼Œæ²¡åŠæ³•ç”¨ä¸€ä¸ªå›ºå®šçš„èŒƒå›´å»è¡¨è¾¾æ‰€æœ‰çš„ Emojiã€‚<p>äºæ˜¯åˆæœç´¢äº†ä¸€ä¸‹ï¼ŒStackOverflow æœ‰ä¸€ä¸ª<a href=https://stackoverflow.com/questions/18862256/how-to-detect-emoji-using-javascript>å›ç­”</a>ï¼Œé‡Œé¢æåˆ°äº†ç”¨ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape>Unicode character class escape</a> è¿›è¡ŒåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯ <code>/\p{Emoji}/u</code> å’Œ <code>/\p{Extended_Pictographic}/u</code> ã€‚<dl><dt><code>/\p{Emoji}/u</code><dd><p>æ—¢ç„¶æ˜¯åŒ¹é… Emojiï¼Œé‚£ä¹ˆ loneProperty (\p{loneProperty}) å°±åº”è¯¥æ˜¯ Emoji ? å®é™…æµ‹è¯•å¹¶ä¸ç¬¦åˆéœ€æ±‚ï¼Œå› ä¸ºåœ¨<a href=https://www.unicode.org/Public/15.1.0/ucd/emoji/emoji-data.txt>Emoji å®˜æ–¹æ–‡æ¡£</a>ä¸­ï¼Œ <code class=verbatim>123456789*#</code> ä¹Ÿæ˜¯è¢«çœ‹ä½œæ˜¯ Emojiï¼Œ
å¦‚æœç”¨è¿™ä¸ªæ­£åˆ™çš„è¯ï¼Œå°±ä¼šæŠŠæ•°å­—ä¹Ÿè®¤ä¸ºæ˜¯ Emojiï¼Œä¸ç¬¦åˆåªæ’é™¤ç‰¹æ®Šè¡¨æƒ…çš„è¦æ±‚ã€‚<dt><code>/\p{Extended_Pictographic}/u</code><dd><p>è€Œ Extended_Pictographic è¡¨ç¤ºçš„ Emoji æ‰æ˜¯æˆ‘ä»¬è®¤ä¸ºçš„é‚£äº›è¡¨æƒ…ç¬¦å·ã€‚</dl><div><div><div><table><tbody><tr><td><pre class=chroma><code> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
</code></pre><td><pre class=chroma><code class=language-typescript>  console.log(
    /\p{Emoji}/u.test(&#39;flowers&#39;), // false :)
    /\p{Emoji}/u.test(&#39;flowers ğŸŒ¼ğŸŒºğŸŒ¸&#39;), // true :)
    /\p{Emoji}/u.test(&#39;flowers 123&#39;), // true :(
  )
  console.log(
    /\p{Extended_Pictographic}/u.test(&#39;flowers&#39;), // false :)
    /\p{Extended_Pictographic}/u.test(&#39;flowers ğŸŒ¼ğŸŒºğŸŒ¸&#39;), // true :)
    /\p{Extended_Pictographic}/u.test(&#39;flowers 123&#39;), // false :)
  )</code></pre></table></div></div></div></div></div><div><h2>Unicode character class escpae</h2><div><p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape>Unicode character class escape: \p{â€¦}, \P{â€¦}</a> æ˜¯ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Character_class_escape>Character class escape</a> ä¸­çš„ä¸€ç§ã€‚<p>å¹³æ—¶æ­£åˆ™ä¸­å¸¸ç”¨çš„ \d,\D,\w,\W å°±æ˜¯ Character class escapeï¼Œå°±æ˜¯ç”¨æ¥è¡¨è¾¾ä¸€ç»„å­—ç¬¦çš„è½¬ä¹‰åºåˆ—(escape sequence)ã€‚<p>ä¾‹å¦‚ <code class=verbatim>\d</code> è¿™ä¸ªè½¬ä¹‰åºåˆ—è¡¨è¾¾çš„å°±æ˜¯ <code class=verbatim>[0-9]</code> çš„ä¸€ç»„å­—ç¬¦ ã€‚<p>è€Œ <code class=verbatim>\p{...}</code> , <code class=verbatim>\P{...}</code> ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ä»–ä»¬ç”¨æ¥è¡¨è¾¾ä¸€ç»„ Unicdoe å­—ç¬¦ï¼Œé€šè¿‡æŒ‡å®š <a href=https://tc39.es/ecma262/multipage/text-processing.html#table-binary-unicode-properties>Unicode property</a> å†³å®šåŒ¹é…ä»€ä¹ˆ Unicodeã€‚<p>ä¾‹å¦‚å¯ä»¥ç”¨ <code class=verbatim>/\p{Hex_Digit}/u</code> å»åŒ¹é… 16 è¿›åˆ¶çš„å­—ç¬¦ï¼š<p><a href=https://taxodium.ink/post/emoji-regexp/regexp101-emoji-hex-digit.png><img src=https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/8d982b1c.png></a><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ Unicode character class escpae è¦å¯ç”¨ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/unicode#unicode-aware_mode>unicode-aware mode</a>ï¼Œå³åŠ ä¸Š <code class=verbatim>/u</code> æ ‡è®°ã€‚</div></div><div><h2>String &amp; Unicode</h2><div><blockquote><p>Strings are represented fundamentally as sequences of <a href=https://en.wikipedia.org/wiki/UTF-16>UTF-16</a> code
units. In UTF-16 encoding, every code unit is exact 16 bits long. This
means there are a maximum of 2^16, or 65536 possible characters
representable as single UTF-16 code units.<p>â€¦<p>However, the entire Unicode character set is much, much bigger
than 65536. The extra characters are stored in UTF-16 as surrogate
pairs, which are pairs of 16-bit code units that represent a single
character.To avoid ambiguity, the two parts of the pair must be
between 0xD800 and 0xDFFF, and these code units are not used to encode
single-code-unit characters. (More precisely, leading surrogates, also
called <strong>high-surrogate</strong> code units, have values between <strong>0xD800 and
0xDBFF</strong>, inclusive, while trailing surrogates, also called
<strong>low-surrogate</strong> code units, have values between <strong>0xDC00 and 0xDFFF</strong>,
inclusive.) Each Unicode character, comprised of one or two UTF-16
code units, is also called a <strong>Unicode code point</strong>. Each Unicode code
point can be written in a string with \u{xxxxxx} where xxxxxx
represents 1â€“6 hex digits.<p>â€”â€” <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#utf-16_characters_unicode_code_points_and_grapheme_clusters>UTF-16 characters, Unicode code points, and grapheme clusters</a></blockquote><p>åœ¨ JavaScript ä¸­ï¼ŒString å®é™…æ˜¯ UTF-16 (16-bit Unicode Transformation Format) ç¼–ç çš„ï¼Œå®ƒä»¥ 16 ä½å»è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼ˆcode unitï¼‰ï¼Œæœ€å¤šå¯ä»¥è¡¨ç¤º 65536 (0x0000 - 0xFFFF) ä¸ªå­—ç¬¦ã€‚<p>è¿™ 65535 ä¸ªå­—ç¬¦ä¸­åŒ…å«äº†å¤§éƒ¨åˆ†å¸¸ç”¨å­—ç¬¦ï¼Œä¾‹å¦‚å­—æ¯ï¼Œæ•°å­—ï¼Œæ‹‰ä¸å­—ç¬¦ï¼Œä»¥åŠä¸€äº›ä¸œäºšæ–‡å­—å­—ç¬¦ã€‚<p>ä½†æ˜¯åæ¥å‘ç° 65535 å¹¶ä¸è¶³ä»¥è¡¨è¾¾æ‰€æœ‰å­—ç¬¦ï¼Œ16 ä½ä¸å¤Ÿï¼Œé‚£å°±éœ€è¦å¢åŠ  Unicode å»è¡¨è¾¾æ›´å¤šå­—ç¬¦ã€‚<p>å®ç°çš„æ–¹æ³•å°±æ˜¯å®šä¹‰äº† <strong>ä»£ç†å¯¹ (Surrogates pairs)</strong> , ä»£ç†å¯¹ç”± 20 ä½ç»„æˆã€‚<p>è§„å®šå‰ 10 ä½ä½œä¸º <strong>é«˜ä»£ç†ä½ (high-surrogate)</strong> ï¼Œå–å€¼èŒƒå›´æ˜¯ 0xD800 - 0xDBFFã€‚<p>å 10 ä½ä¸º <strong>ä½ä»£ç†ä½ (low-surrogate)</strong> ï¼Œå–å€¼èŒƒå›´æ˜¯ 0xDC00 - 0xDFFFã€‚<p>é«˜ä»£ç†ä½å’Œä½ä»£ç†ä½ç»„æˆä»£ç†å¯¹ (surrogate pairs) ã€‚<p>ç”±äºæœ‰ 20 ä½çš„é•¿åº¦ï¼Œå› æ­¤å¯ä»¥è¡¨è¾¾ 1048576 ä¸ªå­—ç¬¦ï¼Œå¯ä»¥åœ¨åŸæ¥ 65536 ä¸ªå­—ç¬¦ä¹‹ä¸Šï¼Œå†å¢åŠ  1048576 ä¸ªå­—ç¬¦ã€‚<p>ä¸ºä»€ä¹ˆ Unicode è¦è¿™ä¹ˆè®¾è®¡ï¼Œå¯ä»¥å‚è€ƒ <a href=https://stackoverflow.com/questions/42181070/why-does-code-points-between-ud800-and-udbff-generate-one-length-string-in-ecm>Why does code points between U+D800 and U+DBFF generate one-length string in ECMAScript 6?</a><p>ä¸ºä»€ä¹ˆé«˜ä»£ç†å’Œä½ä»£ç†è¿™ä¹ˆå–å€¼ï¼Œå¯ä»¥å‚è€ƒ <a href=https://stackoverflow.com/questions/5178202/how-was-the-position-of-the-surrogates-area-utf-16-chosen>How was the position of the Surrogates Area (UTF-16) chosen?</a>ï¼‰<p>æ¦‚æ‹¬æ¥è¯´ï¼Œå°±æ˜¯åœ¨ JavaScript çš„ String ä¸­å¸¸ç”¨çš„å­—ç¬¦ï¼ˆå¦‚å­—æ¯ï¼Œæ•°å­—ï¼Œæ±‰å­—ï¼‰æ˜¯ç”± 1 ä¸ª UTF-16 ç¼–ç å•å…ƒè¡¨ç¤ºçš„ã€‚<p>è€Œè¶…å‡º 65535 (0xFFFF, U+FFFF, \uFFFF) å­—ç¬¦ï¼ˆå¦‚ Emojiï¼‰ï¼Œåˆ™ç”±ä»£ç†å¯¹è¡¨ç¤ºï¼ˆé«˜ä»£ç†+ä½ä»£ç†ï¼Œ2 ä¸ª UTF-16 ç¼–ç å•å…ƒï¼‰ã€‚</div></div><div><h2>ä¸ºä»€ä¹ˆ /(\ud83c[\udf00-\udfff]â€¦/u çš„æ­£åˆ™æ— æ³•åŒ¹é…ğŸ‰</h2><div><p>ç°åœ¨å·²ç»çŸ¥é“ Emoji æ˜¯é€šè¿‡ä»£ç†å¯¹è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆ ğŸ‰ çš„ä»£ç†å¯¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<p>å¯ä»¥é€šè¿‡ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt>String.prototype.chartAt()</a> æˆ– <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split>String.prototype.split()</a> è·å¾—ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
3
</code></pre><td><pre class=chroma><code class=language-typescript>  &#39;ğŸ‰&#39;.charAt(0) // &#39;\uD83C&#39;
  &#39;ğŸ‰&#39;.charAt(1) // &#39;\uDE50&#39;
  &#39;ğŸ‰&#39;.split(&#34;&#34;) // [&#39;\uD83C&#39;, &#39;\uDE50&#39;]
</code></pre></table></div></div></div><p>æ‰€ä»¥ ğŸ‰ çš„é«˜ä»£ç†æ˜¯ \uD83Cï¼Œä½ä»£ç†æ˜¯ \uDE50ã€‚<p>å’Œ <code class=verbatim>(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f\ude80-\udeff])|[\u2600-\u2B55]</code> å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œæ­£åˆ™çš„èŒƒå›´ä¸åŒ…æ‹¬ \uD83C\uDE50ï¼Œæ‰€ä»¥åŒ¹é…ä¸åˆ°ğŸ‰ã€‚</div></div><div><h2>String ä¸­çš„ç›¸å…³æ–¹æ³•</h2><div><dl><dt><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt>String.prototype.charAt()</a><dd><blockquote><p>The charAt() method of String values returns a new string consisting of the single UTF-16 code unit at the given index.</blockquote><p>charAt() è¿”å›å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„å•ä¸ª UTF-16 ç¼–ç å•å…ƒã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
3
4
5
6
7
8
</code></pre><td><pre class=chroma><code class=language-typescript>    &#39;ğŸ‰&#39;.charAt(0) // &#39;\uD83C&#39;
    &#39;ğŸ‰&#39;.charAt(1) // &#39;\uDE50&#39;

    &#39;a&#39;.charAt(0) // &#39;a&#39;
    &#39;a&#39;.charAt(1) // &#39;&#39;

    &#39;apple&#39;.charAt(0) // &#39;a&#39;
    &#39;apple&#39;.charAt(1) // &#39;p&#39;
</code></pre></table></div></div></div><dt><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt>String.property.charCodeAt()</a><dd><blockquote><p>The charCodeAt() method of String values returns an integer between 0 and 65535 representing the UTF-16 code unit at the given index.</blockquote><p>charCodeAt() è¿”å›å­—ç¬¦ä¸€ä¸ª <code class=verbatim>0-65535</code> ä¹‹é—´çš„ <code class=verbatim>æ•°å­—(integer)</code> , æ˜¯å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„ UTF-16 ç¼–ç å•å…ƒå¯¹åº”çš„æ•°å€¼ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
3
4
5
6
7
8
</code></pre><td><pre class=chroma><code class=language-typescript>    &#39;ğŸ‰&#39;.charCodeAt(0) // 55356
    &#39;ğŸ‰&#39;.charCodeAt(1) // 56912

    &#39;a&#39;.charCodeAt(0) // 97
    &#39;a&#39;.charCodeAt(1) // NaN

    &#39;apple&#39;.charCodeAt(0) // 97
    &#39;apple&#39;.charCodeAt(1) // 112
</code></pre></table></div></div></div><dt><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode>String.fromCharCode()</a><dd><blockquote><p>The String.fromCharCode() static method returns a string created from the specified sequence of UTF-16 code units.</blockquote><p>fromCharCode() å¯ä»¥æ¥å—å¤šä¸ª 0-65535 ä¹‹é—´çš„æ•°å­—ï¼Œè¿”å›è¿™äº› char code ç»„æˆçš„å­—ç¬¦ä¸²ã€‚<p>fromCharCode() å’Œ charCodeAt() æ˜¯å¯¹åº”çš„ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
</code></pre><td><pre class=chroma><code class=language-typescript>    &#39;ğŸ‰&#39;.charCodeAt(0) // 55356
    &#39;ğŸ‰&#39;.charCodeAt(1) // 56912
    String.fromCharCode(55356, 56912) // &#39;ğŸ‰&#39;

    &#39;apple&#39;.charCodeAt(0) // 97
    &#39;apple&#39;.charCodeAt(1) // 112
    &#39;apple&#39;.charCodeAt(2) // 112
    &#39;apple&#39;.charCodeAt(3) // 108
    &#39;apple&#39;.charCodeAt(4) // 101
    String.fromCharCode(97, 112, 112, 108, 101) // &#39;apple&#39;
</code></pre></table></div></div></div><dt><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt>String.prototype.codePointAt()</a><dd><blockquote><p>The codePointAt() method of String values returns a non-negative integer that is the Unicode code point value of the character starting at the given index.<p>Note that the index is still based on UTF-16 code units, not Unicode code points.</blockquote><p>codePointAt() è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ˜¯å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„å¯¹åº”çš„ Unicode code point(ä¸å±€é™åœ¨ 0-65535, è€Œæ˜¯ 0-1114111 (0x10FFFF))ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
3
4
5
6
7
8
</code></pre><td><pre class=chroma><code class=language-typescript>  &#39;ğŸ‰&#39;.charCodeAt(0) // 55356
  &#39;ğŸ‰&#39;.charCodeAt(1) // 56912

  &#39;ğŸ‰&#39;.codePointAt(0) // 127568
  // éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹æ ‡æ˜¯åŸºäº UTF-16 è®¡ç®—çš„ï¼ŒğŸ‰ æ˜¯ç”±ä¸¤ä¸ª UTF-16 ç»„æˆçš„
  // å¯¹äºä¸‹æ ‡ 0ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªä»£ç†å¯¹ï¼Œå¯¹åº” Unicode code pointï¼Œæ‰€ä»¥è¿”å›äº† 127568
  // å¯¹äºä¸‹æ ‡ 1ï¼Œç”±äºåªæœ‰ä½ä»£ç†ä½ï¼Œæ— æ³•ç»„æˆä»£ç†å¯¹ï¼Œå°±è¿”å›ä½ä»£ç†ä½å¯¹åº”çš„ Unicode Code Point
  &#39;ğŸ‰&#39;.codePointAt(1) // 56912
</code></pre></table></div></div></div><dt><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint>String.fromCodePoint()</a><dd><blockquote><p>The String.fromCodePoint() static method returns a string created from the specified sequence of code points.</blockquote><p>fromCodePoint() å¯ä»¥æ¥å—å¤šä¸ª codePoint æ•°å­—ï¼Œè¿”å›å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚<p>fromCharCode() çš„æ¯ä¸ªå‚æ•°åªèƒ½æ˜¯ 0-65535 èŒƒå›´çš„æ•°å­—ï¼Œè€Œ fromCodePoint() åˆ™å¯ä»¥è¾“å…¥ 0-1114111 èŒƒå›´çš„æ•°å­—ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
</code></pre><td><pre class=chroma><code class=language-typescript>  // fromCodePoint
  String.fromCodePoint(127568) // &#39;ğŸ‰&#39;
  String.fromCodePoint(55356, 56912) // &#39;ğŸ‰&#39;

  // fromCharCode
  // fromCharCode åªèƒ½å¤„ç† 0-65535 ä¹‹é—´çš„æ•°å­—ï¼Œå¯¹äºè¶…è¿‡ 65535 çš„æ•°å­—ï¼Œåˆ™æˆªæ–­åˆ°æœ€åçš„ 16 ä½æ•°å­—
  // ç­‰åŒäº String.fromCharCode(62032)
  // Number(127568).toString(16) -&gt; &#39;1f250&#39; -&gt; æˆªå–æœ€åçš„ 16 ä½ï¼Œå³ f250
  // Number.parseInt(&#39;f250&#39;, 16) -&gt; 62032
  String.fromCharCode(127568) // &#39;ï‰&#39;
  String.fromCharCode(55356, 56912) // &#39;ğŸ‰&#39;
</code></pre></table></div></div></div></dl></div></div><div><h2>æ³¨æ„ç‚¹</h2><div><div><h3>å­—ç¬¦ä¸²é•¿åº¦</h3><div><p>æœ‰çš„å­—ç¬¦æ˜¯ç”±ä»£ç†å¯¹ç»„æˆçš„ï¼Œæ˜¯ä¸¤ä¸ª UTF-16 ç¼–ç å•å…ƒï¼Œä¾‹å¦‚ Emojiã€‚<p>å½“éœ€è¦è®¡ç®—ä»–ä»¬é•¿åº¦çš„æ—¶å€™ï¼Œéœ€è¦æ„è¯†åˆ°ä»–ä»¬æ˜¯ä»£ç†å¯¹ï¼Œå–å†³äºå…·ä½“éœ€æ±‚å»ç»Ÿè®¡é•¿åº¦ã€‚<div><div><div><table><tbody><tr><td><pre class=chroma><code>1
2
3
</code></pre><td><pre class=chroma><code class=language-typescript>  &#39;a&#39;.length // 1

  &#39;ğŸ‰&#39;.length // 2
</code></pre></table></div></div></div></div></div><div><h3>Lone surrogates</h3><div><p>ä»£ç†å¯¹æ˜¯ç”±é«˜ä»£ç†å’Œä½ä»£ç†ç»„æˆçš„ï¼Œå¦‚æœå•ç‹¬æŠŠé«˜ä»£ç†æ‹å‡ºæ¥ï¼Œæˆ–è€…é«˜ä»£ç†å’Œé«˜ä»£ç†ç»„æˆä»£ç†å¯¹ï¼Œæ˜¯æ— æ³•è¡¨è¾¾æœ‰å«æ„çš„ Unicode å­—ç¬¦çš„ã€‚<p>å…·ä½“å¯ä»¥å‚è€ƒ <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#utf-16_characters_unicode_code_points_and_grapheme_clusters>UTF-16 characters, Unicode code points, and grapheme clusters</a>ã€‚</div></div></div></div><div><h2>Refs</h2><div><ul><li><p><a href=https://stackoverflow.com/questions/18862256/how-to-detect-emoji-using-javascript>How to detect emoji using javascript</a><li><p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape>Unicode character class escape: \p{â€¦}, \P{â€¦}</a><li><p><a href=https://tc39.es/ecma262/multipage/text-processing.html#table-binary-unicode-properties>Binary Unicode property aliases and their canonical property names</a></ul></div></div></div></article></main>
<hr>
<footer>
        <label>åŸç½‘å€: <a href="https://taxodium.ink/post/emoji-regexp/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">è®¿é—®</a></label><br/>
        <label>åˆ›å»ºæ—¶é—´: 2024-05-17 09:45:11</label><br/>
        <br/>
        
      </footer>
</body>
</html>