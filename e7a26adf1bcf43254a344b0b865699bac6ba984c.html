<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web-Component-å³å°†çˆ†å‘çš„åŸç”Ÿçš„-UI-ç»„ä»¶åŒ–æ ‡å‡†</title>
    <link rel="stylesheet" href="https://c1312.netlify.app/typo.css">
    <link rel="stylesheet" href="https://c1312.netlify.app/style.css">
</head>
<body>
<header>
  <h1>Web-Component-å³å°†çˆ†å‘çš„åŸç”Ÿçš„-UI-ç»„ä»¶åŒ–æ ‡å‡†</h1>
</header>
<main class="typo"><div><p><h2>Web Component æ¦‚è¿°</h2><p>Web Component æ˜¯ä¸€ç§ç”¨äºæ„å»º<em>å¯å¤ç”¨ç”¨æˆ·ç•Œé¢ç»„ä»¶</em>çš„æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„ HTML æ ‡ç­¾ï¼Œå¹¶å°†å…¶å°è£…ä¸ºåŒ…å«é€»è¾‘å’Œæ ·å¼çš„ç‹¬ç«‹ç»„ä»¶ï¼Œä»è€Œåœ¨ä»»ä½• Web åº”ç”¨ä¸­é‡å¤ä½¿ç”¨ã€‚<p>æ¯ä¸ª Web Component éƒ½å…·æœ‰è‡ªå·±çš„ DOM å’Œæ ·å¼éš”ç¦»ï¼Œé¿å…äº†å…¨å±€ CSS å’Œ JavaScript çš„å†²çªé—®é¢˜ã€‚å®ƒè¿˜æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶å’Œå±æ€§ï¼Œå¯ä»¥ä¸å…¶ä»–ç»„ä»¶è¿›è¡Œé€šä¿¡å’Œäº¤äº’ã€‚<p>ä¸åŒäº Vue/React ç­‰ç¤¾åŒºæˆ–å‚å•†çš„ç»„ä»¶åŒ–å¼€å‘æ–¹æ¡ˆï¼ŒWeb Component è¢«å®šä¹‰åœ¨æ ‡å‡†çš„ HTML å’Œ DOM æ ‡å‡†ä¸­ã€‚å®ƒç”±ä¸€ç»„ç›¸å…³çš„ Web å¹³å° API ç»„æˆï¼Œä¹Ÿå¯ä»¥ä¸ç°æœ‰çš„å‰ç«¯æ¡†æ¶å’Œåº“é…åˆä½¿ç”¨ã€‚<p>Web Component çš„å…¼å®¹æ€§è‰¯å¥½ï¼Œå¯ä»¥åœ¨ç°ä»£æµè§ˆå™¨ä¸­ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ polyfill å…¼å®¹åˆ°æ—§ç‰ˆæµè§ˆå™¨*ï¼ˆIE11 ç†è®ºä¸Šå¯ä»¥å…¼å®¹ï¼Œå‡ºäºåˆæ­¥è°ƒç ”çš„è€ƒè™‘ï¼Œæœ¬æ–‡ä¸å¯¹<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcaniuse.com%2F">å…¼å®¹æ€§</a>ä½œè¿‡å¤šæ¢è®¨ï¼‰*ã€‚<h3>åŒç±»ç»„ä»¶åŒ–æ–¹æ¡ˆæ¯”è¾ƒ</h3><table><thead><tr><th>Pros<th>æŠ€æœ¯<th>Cons<tbody><tr><td>å¯ä»¥å¼‚æ„<td><strong>Micro Frontend</strong><td>éœ€è¦ä¸»åº”ç”¨ã€å¯¹å­åº”ç”¨æœ‰ä¾µå…¥ã€æ ·å¼ç»Ÿä¸€å›°éš¾<tr><td>æ¨¡å—çº§çš„å¤šé¡¹ç›®åœ¨è¿è¡Œæ—¶å…±äº«<td><strong>Module Federation</strong><td>ä¸»è¦ä¾èµ–webpack5ï¼Œæ—¢æœ‰é¡¹ç›®æ”¹é€ æˆæœ¬æœªçŸ¥ï¼›å®ç°å¼‚æ„å¼•ç”¨éœ€è¦å€ŸåŠ©<a href="https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F649582091">å…¶ä»–æ’ä»¶</a><tr><td>æ¨¡å—çº§åŠ¨æ€å…±äº«<td><strong>Vue <code>:is</code> + åŠ¨æ€<code>import</code></strong><td>ä¾èµ–vueæŠ€æœ¯æ ˆ<tr><td>å¯ä»¥å¼‚æ„ã€å®Œå…¨è§£è€¦ã€å¯¹åŸæœ‰å¼€å‘æ–¹æ³•æ”¹é€ æå°<td><strong>Web Compnent</strong><td>IEå…¼å®¹æ€§ä»…11å¯é€šè¿‡Polyfillæ”¯æŒ</table><h2>TL;DR</h2><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Ftonylua%2Fweb-component-test1%2Ftree%2Fmaster"><img src=https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/1ebf8733.webp> å®ä¾‹ï¼šç”¨å¼‚æ„ç³»ç»Ÿå…±å»º web components</a><h2>Web Component å…³é”®ç‰¹æ€§</h2><h3><a href="https://link.juejin.cn/?target=https%3A%2F%2Fhtml.spec.whatwg.org%2Fmultipage%2Fcustom-elements.html%23custom-elements">Custom Elementsï¼ˆè‡ªå®šä¹‰å…ƒç´ ï¼‰</a></h3><p>æ˜¯ Web æ ‡å‡†ä¸­çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå…è®¸å¼€å‘è€…è‡ªå®šä¹‰æ–°çš„ HTML å…ƒç´ ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript å’Œ DOM APIï¼Œä½¿æ–°å…ƒç´ å…·æœ‰è‡ªå®šä¹‰çš„è¡Œä¸ºå’ŒåŠŸèƒ½<blockquote><h5>4.13.1.1 Creating an autonomous custom element<a href=#custom-elements-autonomous-example></a></h5><p><em>This section is non-normative.</em><p>For the purposes of illustrating how to create an <a href=#autonomous-custom-element>autonomous custom element</a>, let&#39;s define a custom element that encapsulates rendering a small icon for a country flag. Our goal is to be able to use it like so:<pre><code class="hljs language-ini code-block-extension-codeShowNum">
</code></pre><p>To do this, we first declare a class for the custom element, extending <code>HTMLElement</code>:<pre><code class="hljs language-javascript code-block-extension-codeShowNum">class FlagIcon extends HTMLElement {
  constructor() {
    super();
    this._countryCode = null;
  }

  static observedAttributes = [&#34;country&#34;];

  attributeChangedCallback(name, oldValue, newValue) {
    // name will always be &#34;country&#34; due to observedAttributes
    this._countryCode = newValue;
    this._updateRendering();
  }
  connectedCallback() {
    this._updateRendering();
  }

  get country() {
    return this._countryCode;
  }
  set country(v) {
    this.setAttribute(&#34;country&#34;, v);
  }

  _updateRendering() {
    ...
  }
}
</code></pre><p>We then need to use this class to define the element:<pre><code class="hljs language-makefile code-block-extension-codeShowNum">customElements.define(&#34;flag-icon&#34;, FlagIcon);
</code></pre></blockquote><ul><li>ç»§æ‰¿è‡ªåŸºç±» HTMLElement<li>è‡ªå®šä¹‰çš„å…ƒç´ åç§°éœ€ç¬¦åˆ DOMString æ ‡å‡†ï¼Œç®€å•æ¥è¯´å°±æ˜¯å¿…é¡»å¸¦çŸ­æ¨ªçº¿<li>å…¶ä¸­ observedAttributes å£°æ˜çš„å±æ€§æ‰èƒ½è¢« attributeChangedCallback() ç›‘å¬<li>å®Œæ•´ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è¯´æ˜ä¸º:</ul><pre><code class="hljs language-scala code-block-extension-codeShowNum">class MyCustomElement extends HTMLElement {
  constructor() {
    super();
    // åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–æ“ä½œ
    // ç”¨ this.appendChild(...) ç­‰æŒ‚è½½åˆ°domä¸­
    // ç”¨ addEventListener() ç»‘å®šäº‹ä»¶åˆ° this.xxx ä¸Š
  }
  connectedCallback() {
    // å…ƒç´ è¢«æ’å…¥åˆ°æ–‡æ¡£æ—¶è§¦å‘ï¼Œç­‰ä»·äº vue çš„ mounted
  }
  disconnectedCallback() {
    // å…ƒç´ ä»æ–‡æ¡£ä¸­ç§»é™¤æ—¶è§¦å‘ï¼Œç­‰ä»·äº vue çš„ beforeDestory / destoyed
  }
  attributeChangedCallback(attributeName, oldValue, newValue) {
    // å…ƒç´ çš„å±æ€§è¢«æ·»åŠ ã€ç§»é™¤æˆ–æ›´æ”¹æ—¶è§¦å‘ï¼Œç­‰ä»·äº vue çš„ beforeUpdate / updated
  }
}
</code></pre><p>é™¤äº†ç»§æ‰¿ HTMLElementï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿å…¶æ—¢æœ‰å­ç±»ï¼Œå¹¶åœ¨ä½¿ç”¨æ˜¯é‡‡ç”¨åŸç”Ÿæ ‡ç­¾ï¼ˆè¢«ç»§æ‰¿ç±»ï¼‰ + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTML%2FGlobal_attributes%2Fis">is</a> è¯­æ³•ï¼Œå¦‚ï¼š<pre><code class="hljs language-scala code-block-extension-codeShowNum">// Create a class for the element
class WordCount extends HTMLParagraphElement {
  constructor() {
    // Always call super first in constructor
    super();

    // Constructor contents omitted for brevity
    // â€¦
  }
}

// Define the new element
customElements.define(&#34;word-count&#34;, WordCount, { extends: &#34;p&#34; });
</code></pre><pre><code class="hljs language-ini code-block-extension-codeShowNum">
</code></pre><h3><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fshadow-dom%2F">Shadow DOM</a></h3><p>DOM ç¼–ç¨‹æ¨¡å‹ä»¤äººè¯Ÿç—…çš„ä¸€ä¸ªæ–¹é¢å°±æ˜¯ç¼ºä¹<strong>å°è£…</strong>ï¼Œä¸åŒç»„ä»¶ä¹‹é—´çš„é€»è¾‘å’Œæ ·å¼å¾ˆå®¹æ˜“äº’ç›¸æ±¡æŸ“ã€‚<p>é‰´äºè¿™ä¸ªåŸå› ï¼ŒWeb components çš„ä¸€ä¸ªé‡è¦å±æ€§å°±æ˜¯<strong>å°è£…</strong>â€”â€”å¯ä»¥å°†æ ‡è®°ç»“æ„ã€æ ·å¼å’Œè¡Œä¸ºéšè—èµ·æ¥ï¼Œå¹¶ä¸é¡µé¢ä¸Šçš„å…¶ä»–ä»£ç ç›¸éš”ç¦»ã€‚å…¶ä¸­ï¼ŒShadow DOM æ¥å£æ˜¯å…³é”®æ‰€åœ¨ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªéšè—çš„ã€ç‹¬ç«‹çš„ DOM é™„åŠ åˆ°ä¸€ä¸ªå…ƒç´ ä¸Š<p>Shadow DOM æ˜¯ DOM nodes çš„é™„å±æ ‘ã€‚è¿™ç§ Shadow DOM å­æ ‘å¯ä»¥ä¸æŸå®¿ä¸»å…ƒç´ ç›¸å…³è”ï¼Œä½†å¹¶ä¸ä½œä¸ºè¯¥å…ƒç´ çš„æ™®é€šå­èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä¼šå½¢æˆå…¶è‡ªæœ‰çš„ä½œç”¨åŸŸï¼›Shadow DOM ä¸­çš„æ ¹åŠå…¶å­èŠ‚ç‚¹ä¹Ÿä¸å¯è§ã€‚<p>ç›¸æ¯”äºä»¥å‰ä¸ºäº†å®ç°å°è£…è€Œåªèƒ½ä½¿ç”¨ <code>&lt;iframe&gt;</code> å®ç°çš„æƒ…å†µï¼ŒShadow DOM æ— ç–‘æ˜¯ä¸€ç§æ›´ä¼˜é›…çš„åˆ›å»ºéš”ç¦» DOM æ ‘çš„æ–¹æ³•ã€‚<blockquote><p><em>Shadow</em> DOM å…è®¸å°†éšè—çš„ DOM æ ‘é™„åŠ åˆ°å¸¸è§„çš„ DOM æ ‘ä¸­â€”â€”å®ƒä»¥ shadow root èŠ‚ç‚¹ä¸ºèµ·å§‹æ ¹èŠ‚ç‚¹ï¼Œåœ¨è¿™ä¸ªæ ¹èŠ‚ç‚¹çš„ä¸‹æ–¹ï¼Œå¯ä»¥æ˜¯ä»»æ„å…ƒç´ ï¼Œå’Œæ™®é€šçš„ DOM å…ƒç´ ä¸€æ ·ã€‚<p><img src=assets/1694480258-c28375d15b1248dca140f0c3c3e22184.svg><p>è¿™é‡Œï¼Œæœ‰ä¸€äº› Shadow DOM ç‰¹æœ‰çš„æœ¯è¯­éœ€è¦æˆ‘ä»¬äº†è§£ï¼š<ul><li>Shadow hostï¼šä¸€ä¸ªå¸¸è§„ DOM èŠ‚ç‚¹ï¼ŒShadow DOM ä¼šè¢«é™„åŠ åˆ°è¿™ä¸ªèŠ‚ç‚¹ä¸Šã€‚<li>Shadow treeï¼šShadow DOM å†…éƒ¨çš„ DOM æ ‘ã€‚<li>Shadow boundaryï¼šShadow DOM ç»“æŸçš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯å¸¸è§„ DOM å¼€å§‹çš„åœ°æ–¹ã€‚<li>Shadow root: Shadow tree çš„æ ¹èŠ‚ç‚¹ã€‚</ul><p>ä½ å¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹å¼æ¥æ“ä½œ Shadow DOMï¼Œå°±å’Œæ“ä½œå¸¸è§„ DOM ä¸€æ ·â€”â€”ä¾‹å¦‚æ·»åŠ å­èŠ‚ç‚¹ã€è®¾ç½®å±æ€§ï¼Œä»¥åŠä¸ºèŠ‚ç‚¹æ·»åŠ è‡ªå·±çš„æ ·å¼ï¼ˆä¾‹å¦‚é€šè¿‡ <code>element.style</code> å±æ€§ï¼‰ï¼Œæˆ–è€…ä¸ºæ•´ä¸ª Shadow DOM æ·»åŠ æ ·å¼ï¼ˆä¾‹å¦‚åœ¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FElement%2Fstyle"><code>&lt;style&gt;</code></a> å…ƒç´ å†…æ·»åŠ æ ·å¼ï¼‰ã€‚ä¸åŒçš„æ˜¯ï¼ŒShadow DOM å†…éƒ¨çš„å…ƒç´ å§‹ç»ˆä¸ä¼šå½±å“åˆ°å®ƒå¤–éƒ¨çš„å…ƒç´ ï¼ˆé™¤äº† <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3Afocus-within"><code>:focus-within</code></a>ï¼‰ï¼Œè¿™ä¸ºå°è£…æä¾›äº†ä¾¿åˆ©ã€‚<p>æ³¨æ„ï¼Œä¸ç®¡ä»å“ªä¸ªæ–¹é¢æ¥çœ‹ï¼ŒShadow DOM éƒ½ä¸æ˜¯ä¸€ä¸ªæ–°äº‹ç‰©â€”â€”åœ¨è¿‡å»çš„å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œæµè§ˆå™¨ç”¨å®ƒæ¥å°è£…ä¸€äº›å…ƒç´ çš„å†…éƒ¨ç»“æ„ã€‚ä»¥ä¸€ä¸ªæœ‰ç€é»˜è®¤æ’­æ”¾æ§åˆ¶æŒ‰é’®çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FElement%2Fvideo"><code>&lt;video&gt;</code></a> å…ƒç´ ä¸ºä¾‹ã€‚ä½ æ‰€èƒ½çœ‹åˆ°çš„åªæ˜¯ä¸€ä¸ª <code>&lt;video&gt;</code> æ ‡ç­¾ï¼Œå®é™…ä¸Šï¼Œåœ¨å®ƒçš„ Shadow DOM ä¸­ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—çš„æŒ‰é’®å’Œå…¶ä»–æ§åˆ¶å™¨ã€‚Shadow DOM æ ‡å‡†å…è®¸ä½ ä¸ºä½ è‡ªå·±çš„å…ƒç´ ï¼ˆcustom elementï¼‰ç»´æŠ¤ä¸€ç»„ Shadow DOMã€‚<h3>åŸºæœ¬ç”¨æ³•</h3><p>å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FElement%2FattachShadow"><code>Element.attachShadow()</code></a> æ–¹æ³•æ¥å°†ä¸€ä¸ª shadow root é™„åŠ åˆ°ä»»ä½•ä¸€ä¸ªå…ƒç´ ä¸Šã€‚å®ƒæ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¯¥å¯¹è±¡æœ‰ä¸€ä¸ª <code>mode</code> å±æ€§ï¼Œå€¼å¯ä»¥æ˜¯ <code>open</code> æˆ–è€… <code>closed</code>ï¼š<pre><code class="hljs language-ini code-block-extension-codeShowNum">let shadow = elementRef.attachShadow({ mode: &#34;open&#34; });
let shadow = elementRef.attachShadow({ mode: &#34;closed&#34; });
</code></pre><p><code>open</code> è¡¨ç¤ºå¯ä»¥é€šè¿‡é¡µé¢å†…çš„ JavaScript æ–¹æ³•æ¥è·å– Shadow DOMï¼Œä¾‹å¦‚ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FElement%2FshadowRoot"><code>Element.shadowRoot</code></a> å±æ€§ï¼š<pre><code class="hljs language-ini code-block-extension-codeShowNum">let myShadowDom = myCustomElem.shadowRoot;
</code></pre><p>å¦‚æœä½ å°†ä¸€ä¸ª Shadow root é™„åŠ åˆ°ä¸€ä¸ª Custom element ä¸Šï¼Œå¹¶ä¸”å°† <code>mode</code> è®¾ç½®ä¸º <code>closed</code>ï¼Œé‚£ä¹ˆå°±ä¸å¯ä»¥ä»å¤–éƒ¨è·å– Shadow DOM äº†â€”â€”<code>myCustomElem.shadowRoot</code> å°†ä¼šè¿”å› <code>null</code>ã€‚æµè§ˆå™¨ä¸­çš„æŸäº›å†…ç½®å…ƒç´ å°±æ˜¯å¦‚æ­¤ï¼Œä¾‹å¦‚<code>&lt;video&gt;</code>ï¼ŒåŒ…å«äº†ä¸å¯è®¿é—®çš„ Shadow DOMã€‚<p>å¦‚æœä½ æƒ³å°†ä¸€ä¸ª Shadow DOM é™„åŠ åˆ° custom element ä¸Šï¼Œå¯ä»¥åœ¨ custom element çš„æ„é€ å‡½æ•°ä¸­æ·»åŠ å¦‚ä¸‹å®ç°ï¼ˆç›®å‰ï¼Œè¿™æ˜¯ shadow DOM æœ€å®ç”¨çš„ç”¨æ³•ï¼‰ï¼š<pre><code class="hljs language-ini code-block-extension-codeShowNum">let shadow = this.attachShadow({ mode: &#34;open&#34; });
</code></pre><p>å°† Shadow DOM é™„åŠ åˆ°ä¸€ä¸ªå…ƒç´ ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ DOM APIs å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œå°±å’Œå¤„ç†å¸¸è§„ DOM ä¸€æ ·ã€‚<pre><code class="hljs language-ini code-block-extension-codeShowNum">var para = document.createElement(&#39;p&#39;);
shadow.appendChild(para);
etc.
</code></pre></blockquote><p><strong>æ³¨æ„ï¼š</strong><ul><li>è¦ä½¿ç”¨ Chrome è°ƒè¯•å™¨æ£€æŸ¥ Shadow DOMï¼Œéœ€è¦é€‰ä¸­è°ƒè¯•å™¨çš„ <code>Preferences</code> / <code>Elmenets</code> ä¸‹çš„ <code>show user agent shadow DOM</code> æ¡†*ï¼›æ¯”å¦‚å¯¹äºä¸Šæ–‡æåˆ°çš„ <code>&lt;video&gt;</code>ï¼Œåœ¨æ‰“å¼€è¯¥è°ƒè¯•é€‰é¡¹åï¼Œå°±èƒ½åœ¨å…ƒç´ é¢æ¿ä¸­çœ‹åˆ° <code>&lt;video&gt;</code> ä¸‹æŒ‚è½½çš„ shadow tree<li>ä¸€äº›æ¯”è¾ƒæ—§çš„èµ„æ–™ä¸­ä¼šå‡ºç° attachShadow() çš„å‰èº« createShadowRoot()ï¼Œè¯­ä¹‰åŸºæœ¬ç›¸åŒï¼›createShadowRoot()å·²ç»è¢«åºŸå¼ƒï¼Œå®ƒæ˜¯åœ¨ Shadow DOM v0 è§„èŒƒä¸­å¼•å…¥çš„ã€‚Shadow DOM çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ v1ï¼Œæ˜¯ Web æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚</ul><h3><a href="https://link.juejin.cn/?target=https%3A%2F%2Fhtml.spec.whatwg.org%2Fmultipage%2Fscripting.html%23the-template-element">HTML templates</a> å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fhtml.spec.whatwg.org%2Fmultipage%2Fscripting.html%23the-slot-element">slot</a></h3><p><code>&lt;template&gt;</code> å…ƒç´ å…è®¸å¼€å‘è€…åœ¨ HTML ä¸­å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ï¼Œå…¶ä¸­å¯ä»¥åŒ…å«ä»»æ„çš„ HTML ç»“æ„ã€æ–‡æœ¬å’Œå˜é‡å ä½ç¬¦ã€‚æ­¤å…ƒç´ åŠå…¶å†…å®¹ä¸ä¼šåœ¨ DOM ä¸­å‘ˆç°ï¼Œä½†ä»å¯ä½¿ç”¨ JavaScript å»å¼•ç”¨å®ƒã€‚<blockquote><pre><code class="hljs language-xml code-block-extension-codeShowNum">
  My paragraph

</code></pre><p>ä¸Šé¢çš„ä»£ç ä¸ä¼šå±•ç¤ºåœ¨ä½ çš„é¡µé¢ä¸­ï¼Œç›´åˆ°ä½ ç”¨ JavaScript è·å–å®ƒçš„å¼•ç”¨ï¼Œç„¶åæ·»åŠ åˆ° DOM ä¸­ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š<pre><code class="hljs language-ini code-block-extension-codeShowNum">let template = document.getElementById(&#34;my-paragraph&#34;);
let templateContent = template.content;
document.body.appendChild(templateContent);
</code></pre><p>æ¨¡æ¿ï¼ˆTemplateï¼‰æœ¬èº«å°±æ˜¯æœ‰ç”¨çš„ï¼Œè€Œä¸ web ç»„ä»¶ï¼ˆweb componentï¼‰ä¸€èµ·ä½¿ç”¨æ•ˆæœæ›´å¥½ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª web ç»„ä»¶ä½¿ç”¨æ¨¡æ¿ä½œä¸ºé˜´å½±ï¼ˆshadowï¼‰DOM çš„å†…å®¹ï¼Œå«å®ƒ <code>&lt;my-paragraph&gt;</code>ï¼š<pre><code class="hljs language-scala code-block-extension-codeShowNum">customElements.define(
  &#34;my-paragraph&#34;,
  class extends HTMLElement {
    constructor() {
      super();
      let template = document.getElementById(&#34;my-paragraph&#34;);
      let templateContent = template.content;

      const shadowRoot = this.attachShadow({ mode: &#34;open&#34; });
      shadowRoot.appendChild(templateContent.cloneNode(true));
    }
  },
);
</code></pre></blockquote><p>ä½¿ç”¨ <code>&lt;slot&gt;</code> åˆ™èƒ½è¿›ä¸€æ­¥å±•ç¤ºä¸åŒçš„è‡ªå®šä¹‰å†…å®¹ï¼š<blockquote><pre><code class="hljs language-xml code-block-extension-codeShowNum">
  My default text

</code></pre><p>...<pre><code class="hljs language-xml code-block-extension-codeShowNum">
  
    Let&#39;s have some different text!
    In a list!
  

</code></pre></blockquote><h3><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2FCSS_scoping">CSS Scopingï¼ˆå±€éƒ¨ä½œç”¨åŸŸçš„ CSSï¼‰</a></h3><blockquote><p>The <strong>CSS scoping</strong> module defines the CSS scoping and encapsulation mechanisms, focusing on the <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_components%2FUsing_shadow_DOM">Shadow DOM</a> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcss.oddbird.net%2Fscope%2F">scoping</a> mechanism.<p>æ ¹æ® Shadow DOM ä½œç”¨åŸŸæœºåˆ¶ï¼Œ<strong>CSS scoping</strong> æ¨¡å—å®šä¹‰äº† CSS ä½œç”¨åŸŸå’Œå°è£…æœºåˆ¶<p>CSS styles are either global in scope or scoped to a <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2FShadow_tree">shadow tree</a>. Globally scoped styles apply to all the elements in the node tree that match the selector, including custom elements in that tree, but not to the shadow trees composing each custom element. Selectors and their associated style definitions don&#39;t bleed between scopes.<p>CSS æ ·å¼åˆ†ä¸ºå…¨å±€å’Œ shadow tree å±€éƒ¨ä¸¤ç§ã€‚å…¨å±€æ ·å¼åº”ç”¨äºèŠ‚ç‚¹æ ‘ä¸­ä¸é€‰æ‹©å™¨åŒ¹é…çš„æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬è¯¥æ ‘ä¸­çš„è‡ªå®šä¹‰å…ƒç´ ï¼Œä½†ä¸åº”ç”¨äºç»„æˆæ¯ä¸ªè‡ªå®šä¹‰å…ƒç´ çš„shadow treeã€‚é€‰æ‹©å™¨åŠå…¶å…³è”çš„æ ·å¼å®šä¹‰ä¹Ÿä¸ä¼šåœ¨ä½œç”¨åŸŸä¹‹é—´æµé€šã€‚<p>Within the CSS of a shadow tree, selectors don&#39;t select elements outside the tree, either in the global scope or in other shadow trees. Each custom element has its own shadow tree, which contains all the components that make up the custom element (but not the custom element, or &#34;host&#34;, itself).<p>åœ¨ shadow tree çš„ CSS ä¸­ï¼Œé€‰æ‹©å™¨ä¸ä¼šå½±å“æ ‘å¤–éƒ¨çš„å…ƒç´  -- æ— è®ºæ˜¯å…¨å±€ä½œç”¨åŸŸè¿˜æ˜¯å…¶ä»– shadow treeã€‚æ¯ä¸ªè‡ªå®šä¹‰å…ƒç´ éƒ½æœ‰è‡ªå·±çš„ shadow treeï¼Œå®ƒåŒ…å«ç»„æˆè‡ªå®šä¹‰å…ƒç´ çš„æ‰€æœ‰ç»„ä»¶ï¼ˆä½†ä¸åŒ…å«è‡ªå®šä¹‰å…ƒç´ æˆ–â€œå®¿ä¸»â€æœ¬èº«ï¼‰ã€‚</blockquote><h4><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3Ahost"><code>:host</code></a> ä¼ªç±»</h4><p>åœ¨ shadow DOM å†…éƒ¨ï¼Œè¦æƒ³ä¸ºâ€œå®¿ä¸»â€ shadow host æœ¬èº«æ·»åŠ æ ·å¼ï¼Œå¯ä»¥ç”¨ CSS é€‰æ‹©å™¨ <code>:host</code>ï¼š<pre><code class="hljs language-css code-block-extension-codeShowNum">:host {
  /* ... */
}
</code></pre><p><code>:host</code> é€‰æ‹©å™¨è¿˜æœ‰ä¸€ç§<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3Ahost_function">å‡½æ•°å¼çš„ç”¨æ³•</a>ï¼Œæ¥æ”¶ä¸€ä¸ªé€‰æ‹©å™¨å‚æ•°ï¼Œè¯¥å‚æ•°è¡¨ç¤º shadow host æœ¬èº«å…·å¤‡ç‰¹å®šçš„çŠ¶æ€æˆ–æ ·å¼æ—¶æ‰ç”Ÿæ•ˆï¼Œå¦‚ï¼š<pre><code class="hljs language-css code-block-extension-codeShowNum">:host(:hover) {
  background-color: #ccc;
}

:host(.active) {
  color: red;
}

:host(.footer) { // å®¿ä¸»å…ƒç´ åŒ…å«footeræ ·å¼åæ—¶
  color : red; 
}
</code></pre><h3><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3Ahost-context"><code>:host-context</code></a> ä¼ªç±»</h3><p>ä¸ <code>:host(selector)</code> ç”¨æ³•ç±»ä¼¼çš„è¿˜æœ‰ <code>:host-context()</code> ä¼ªç±»ï¼Œä½†æ‰€è°“ context çš„è¯­æ„æŒ‡çš„æ˜¯ï¼Œä½œä¸ºå…¶å‚æ•°çš„é€‰æ‹©å™¨æŒ‡å‘çš„æ˜¯ shadow host å®¿ä¸»å…ƒç´ çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯å…¶ä½œä¸ºå“ªä¸ªç¥–å…ˆå…ƒç´ çš„åä»£æ—¶æ‰ç”Ÿæ•ˆï¼Œå¦‚ï¼š<pre><code class="hljs language-css code-block-extension-codeShowNum">// å½“å®¿ä¸»æ˜¯ h1 åä»£æ—¶
:host-context(h1) {
  font-weight: bold;
}

// å½“ .dark-theme ç±»åº”ç”¨äºä¸»æ–‡æ¡£ body æ—¶
:host-context(body.dark-theme) p {
  color: #fff;
}
</code></pre><h4><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3A%3Apart"><code>::part</code></a> ä¼ªå…ƒç´ </h4><p>ç”¨äºåœ¨çˆ¶é¡µé¢æŒ‡å®š shadow DOM å†…éƒ¨ä½¿ç”¨äº†å¯¹åº” <code>part</code> å±æ€§å…ƒç´ çš„æ ·å¼ï¼š<pre><code class="hljs language-xml code-block-extension-codeShowNum">

	
		My host element!
		xxx
	
	
		#host::part(sp) {
			background-color: aqua;
		}
	


	
	
		var template = document.querySelector(&#39;#template&#39;)
		var root = document.querySelector(&#39;#host&#39;).attachShadow({ mode: &#34;open&#34; });
		root.appendChild(template.content);
	


</code></pre><p><code>::part()</code> åœ¨éµå¾ª Shadow DOM å°è£…æ€§çš„åŒæ—¶ï¼Œæä¾›äº†ä¸€ä¸ª<strong>å®‰å…¨æŒ‡å®šå†…éƒ¨æ ·å¼</strong>çš„é€”å¾„ã€‚<p>ä½†è¿™ä¸æ˜¯å”¯ä¸€çš„æ‰‹æ®µï¼Œ<strong>å¦ä¸€ç§â€œç©¿é€â€æ–¹æ³•æ˜¯é€šè¿‡ CSS è‡ªå®šä¹‰å˜é‡</strong>ï¼š<pre><code class="hljs language-xml code-block-extension-codeShowNum">

   
   	
   		span {
   			background-color: var(--sp-color, red);
   		}
   	
   	My host element will have a blue border!
   	xxx
   
   
   	#host {
   		--sp-color: blue; // ç”Ÿæ•ˆ
   	}
   


   
   
   	var template = document.querySelector(&#39;#template&#39;)
   	var root = document.querySelector(&#39;#host&#39;).attachShadow({ mode: &#34;open&#34; });
   	root.appendChild(template.content);
   


</code></pre><h4><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2F%3A%3Aslotted"><code>::slotted</code></a> ä¼ªå…ƒç´ </h4><p>åœ¨è‡ªå®šä¹‰ç»„ä»¶å†…éƒ¨æŒ‡å®šè¯¥æ ·å¼åï¼Œä»…æœ‰ <strong>è¢«å¤–éƒ¨æˆåŠŸå¡«å……çš„slot</strong> æ‰ä¼šè¢«åŒ¹é…åˆ°ï¼Œä½¿ç”¨é»˜è®¤å€¼çš„ slot ä¸Šåˆ™ä¸ä¼šç”Ÿæ•ˆã€‚<h4>ä¼˜å…ˆçº§</h4><ul><li>å¯¹äºâ€œå®¿ä¸»â€å…ƒç´ ï¼Œå¤–éƒ¨æ ·å¼ä¼˜å…ˆçº§é«˜äºå†…éƒ¨çš„ <code>:host</code><li>å¦‚æœè¦è¦†ç›–çˆ¶é¡µä¸­è®¾ç½®çš„æ ·å¼ï¼Œåˆ™å¿…é¡»åœ¨å®¿ä¸»å…ƒç´ ä¸Šå†…è”å®Œæˆ<li>å¤–éƒ¨ <code>::part</code> æ ·å¼ä¼˜å…ˆçº§é«˜äºå†…éƒ¨å®šä¹‰</ul><p>è§‚å¯Ÿä»¥ä¸‹ä¾‹å­ï¼Œä¼˜å…ˆçº§ blur &gt; green &gt; red:<pre><code class="hljs language-html code-block-extension-codeShowNum">
	
		
			:host {
				border: 1px solid red;
				padding: 10px;
				line-height: 50px;
			}
		
		My host element will have a blue border!
	
	
		#host {
			border-color: green;
		}
	


	
	
		var template = document.querySelector(&#39;#template&#39;)
		var root = document.querySelector(&#39;#host&#39;).attachShadow({ mode: &#34;open&#34; });
		root.appendChild(template.content);
	

</code></pre><h3><a href="https://link.juejin.cn/?target=http%3A%2F%2Fw3c-html-ig-zh.github.io%2Fwebcomponents%2Fspec-zh%2Fshadow%2F%23generatedID-16">Event retargetingï¼ˆäº‹ä»¶çš„é‡å®šå‘ï¼‰</a></h3><p>å½“ shadow DOM ä¸­å‘ç”Ÿçš„äº‹ä»¶åœ¨å¤–éƒ¨è¢«æ•è·æ—¶ï¼Œå°†ä¼šä»¥å…¶ host å…ƒç´ ä½œä¸ºç›®æ ‡ã€‚<blockquote><pre><code class="hljs language-xml code-block-extension-codeShowNum">


customElements.define(&#39;user-card&#39;, class extends HTMLElement {
  connectedCallback() {
    this.attachShadow({mode: &#39;open&#39;});
    this.shadowRoot.innerHTML = `<p>
      <button>Click me</button>
    </p>`;
    this.shadowRoot.firstElementChild.onclick =
      e =&gt; alert(&#34;Inner target: &#34; + e.target.tagName);
  }
});

document.onclick =
  e =&gt; alert(&#34;Outer target: &#34; + e.target.tagName);


æ‰“å°å‡ºï¼š
Inner target: BUTTON
Outer target: USER-CARD
</code></pre></blockquote><p>å¤–éƒ¨æ–‡æ¡£å¹¶ä¸éœ€è¦çŸ¥é“è‡ªå®šä¹‰ç»„ä»¶çš„å†…éƒ¨æƒ…å†µ -- ä»å®ƒçš„è§’åº¦æ¥çœ‹ï¼Œ<strong>äº‹ä»¶æ€»æ˜¯å‘ç”Ÿåœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸Šï¼Œé™¤éäº‹ä»¶å‘ç”Ÿåœ¨ slot çš„å…ƒç´ ä¸Š</strong>ã€‚<blockquote><pre><code class="hljs language-ini code-block-extension-codeShowNum">
John Smith



customElements.define(&#39;user-card&#39;, class extends HTMLElement {
  connectedCallback() {
    this.attachShadow({mode: &#39;open&#39;});
    this.shadowRoot.innerHTML = `<div>
      <b>Name:</b> <slot></slot>
    </div>`;

    this.shadowRoot.firstElementChild.onclick =
      e =&gt; alert(&#34;Inner target: &#34; + e.target.tagName);
  }
});

userCard.onclick = e =&gt; alert(`Outer target: ${e.target.tagName}`);


æ‰“å°å‡ºï¼š
Inner target: BUTTON
Outer target: SPAN
</code></pre></blockquote><h4>ä» Shadow DOM å†…éƒ¨è§¦å‘äº‹ä»¶</h4><p>å¦‚æœè¦å‘é€<a href=https://zh.javascript.info/shadow-dom-events>è‡ªå®šä¹‰äº‹ä»¶</a>ï¼Œå¯ä»¥ä½¿ç”¨ CustomEventï¼Œæ³¨æ„è¦è®¾ç½®å†’æ³¡å’Œ composed<pre><code class="hljs language-php code-block-extension-codeShowNum">this._shadowRoot.dispatchEvent(
  new CustomEvent(&#34;weather-fetched&#34;, {
    bubbles: true,
    composed: true,
    detail: json,
  })
);
</code></pre><h3><a href=https://www.w3.org/TR/html-imports/><del>HTML imports</del></a></h3><p>Web Component æ ‡å‡†ä¸­<strong>è¢«åºŸå¼ƒ</strong>çš„ä¸€ä¸ªè‰æ¡ˆï¼ˆæœ‰<a href=https://www.zhangxinxu.com/wordpress/2021/07/html-rel-import-include/>å¼€æºæ›¿ä»£æ–¹æ¡ˆ</a>ï¼‰ï¼Œç”¨äºå¼•å…¥è‡ªå®šä¹‰ç»„ä»¶çš„ç»“æ„å’Œå®Œæ•´å®šä¹‰ï¼Œä»è€Œå¯ä»¥ç›´æ¥åœ¨ä¸»é¡µé¢ html ä¸­å¼•ç”¨ï¼š<blockquote><pre><code class="hljs language-ini code-block-extension-codeShowNum">


</code></pre></blockquote><h2>Web Component å¼€å‘æ¡†æ¶</h2><p>é™¤äº†åŸç”Ÿå¼€å‘æ–¹æ³•ï¼Œç¤¾åŒºä¸­å¤§é‡æ—¢æœ‰/ç‰¹æœ‰å¼€å‘è¯­è¨€ï¼Œéƒ½å¯ä»¥è½¬è¯‘ä¸º Web Component<h3><a href=https://polymer-library.polymer-project.org/3.0/docs/devguide/feature-overview>Polymer</a></h3><p>Google æ¨å‡ºçš„ Web Components åº“ï¼Œæ”¯æŒæ•°æ®çš„å•å‘å’ŒåŒå‘ç»‘å®šï¼Œå…¼å®¹æ€§è¾ƒå¥½ï¼Œè·¨æµè§ˆå™¨æ€§èƒ½ä¹Ÿè¾ƒå¥½ï¼›åœ¨è¯­æ³•å±‚é¢ï¼ŒPolymer ä¹Ÿæœ€æ¥è¿‘ Web Components çš„åŸç”Ÿè¯­æ³•ã€‚<pre><code class="hljs language-js code-block-extension-codeShowNum">import { PolymerElement, html } from &#39;@polymer/polymer/polymer-element.js&#39;;
import &#39;@polymer/iron-icon/iron-icon.js&#39;; // ä¸€ä¸ªå›¾æ ‡åº“

class IconToggle extends PolymerElement {
  static get template() {
    return html`
      
        :host {
          display: inline-block;
        }
        iron-icon {
          fill: var(--icon-toggle-color, rgba(0,0,0,0));
          stroke: var(--icon-toggle-outline-color, currentcolor);
        }
        :host([pressed]) iron-icon {
          fill: var(--icon-toggle-pressed-color, currentcolor);
        }
      
      
      
    `;
  }
  static get properties () {
    return {
      toggleIcon: {
        type: String
      },
      pressed: {
        type: Boolean,
        notify: true,
        reflectToAttribute: true,
        value: false
      }
    };
  }
  constructor() {
    super();
    this.addEventListener(&#39;click&#39;, this.toggle.bind(this));
  }
  toggle() {
    this.pressed = !this.pressed;
  }
}

customElements.define(&#39;icon-toggle&#39;, IconToggle);
</code></pre><h3><a href=https://lit.dev/>Lit</a></h3><p>Google åœ¨ 2019 å¹´å®£å¸ƒåœæ­¢å¯¹ Polymer çš„è¿›ä¸€æ­¥å¼€å‘ï¼Œè½¬å‘æ”¯æŒ Web Components è§„èŒƒæ›´å¥½çš„ Litï¼›è¿™ä¹Ÿæ˜¯ç›®å‰ç¤¾åŒºä¸­è¢«æ¨èè¾ƒå¤šçš„ä¸€ä¸ª<blockquote><p>The Polymer library is in maintenance mode. For new development, we recommend <strong>Lit</strong>. -- Google</blockquote><pre><code class="hljs language-typescript code-block-extension-codeShowNum">import {html, css, LitElement} from &#39;lit&#39;;
import {customElement, property} from &#39;lit/decorators.js&#39;;

@customElement(&#39;simple-greeting&#39;)
export class SimpleGreeting extends LitElement {
  static styles = css`p { color: blue }`;

  @property()
  name = &#39;Somebody&#39;;

  render() {
    return html`Hello, ${this.name}!`;
  }
}
</code></pre><pre><code class="hljs language-ini code-block-extension-codeShowNum">
</code></pre><h3><a href=http://react.dev/>React</a></h3><p>react åœ¨ v17 ç‰ˆæœ¬ä¹‹åï¼Œå¢åŠ äº†å¯¹äº<a href=https://github.com/facebook/react/pull/22184>åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨ web component</a> çš„æ”¯æŒï¼š<blockquote><p>If you render a tag <strong>with a dash</strong>, like , React will assume you want to render a custom HTML element. In React, rendering custom elements works differently from rendering built-in browser tags:<p>All custom element props are serialized to strings and are always set using attributes.
Custom elements accept class rather than className, and for rather than htmlFor.
If you render a built-in browser HTML element with an <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTML%2FGlobal_attributes%2Fis">is</a> attribute, it will also be treated as a custom element.</blockquote><pre><code class="hljs language-javascript code-block-extension-codeShowNum">import React, { useState }  from &#39;react&#39;;
import &#39;./alert.js&#39;;

export default function App() {
  const [show, setShow] = useState(true);

  return (
    
       setShow(!show)}&gt;toggle alert

       setShow(!show)}&gt;
        This is a Web Component in React
      
    
  );
}
</code></pre><p>è€Œå¦‚æœæƒ³<strong>å°†æ ‡å‡† react ç»„ä»¶åŒ…è£…ä¸º web component</strong>ï¼Œå¯ä»¥åœ¨ react å·¥ç¨‹ä¸­ç›´æ¥ç»“åˆ web component åŸç”Ÿè¯­æ³•ã€ä½¿ç”¨ React å®ŒæˆèŠ‚ç‚¹æ¸²æŸ“ï¼Œå¹¶å¯¼å‡ºæˆç‹¬ç«‹ç»„ä»¶ã€‚<p>æ¯”å¦‚ <a href=https://github.com/dtkelch/react-web-components>Githubä¸Šè¿™ä¸ªä¾‹å­</a>ï¼š<pre><code class="hljs language-typescript code-block-extension-codeShowNum">import * as React from &#34;react&#34;;
import * as ReactDom from &#34;react-dom&#34;;
import { FetchData } from &#34;./fetch-data&#34;;

class StandaloneComponent extends HTMLElement {
  mountPoint!: HTMLSpanElement;
  name!: string;

  connectedCallback() {
    const mountPoint = document.createElement(&#34;span&#34;);
    this.attachShadow({ mode: &#34;open&#34; }).appendChild(mountPoint);

    const name = this.getAttribute(&#34;name&#34;);
    if (name) {
      ReactDom.render(, mountPoint);
    } else {
      console.error(&#34;You must declare a name!&#34;);
    }
  }
}
export default StandaloneComponent;

window.customElements.get(&#34;standalone-component&#34;) ||
  window.customElements.define(&#34;standalone-component&#34;, StandaloneComponent);
</code></pre><p>å¦ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹å¼æ˜¯ä¾é  react ç¤¾åŒºä¸­çš„å·¥å…·ï¼Œå¸¸è§çš„å¦‚ï¼š<ul><li><a href=https://github.com/LukasBombach/react-web-component#readme>react-web-component</a><li><a href=https://github.com/Silind-Software/direflow>direflow</a><li><a href=https://github.com/apearce/react-shadow-root>react-shadow-root</a><li><a href=https://github.com/bitovi/react-to-web-component>react-to-web-component</a></ul><pre><code class="hljs language-javascript code-block-extension-codeShowNum">import r2wc from &#39;@r2wc/react-to-web-component&#39;;
import Checklist from &#39;./components/checklist/Checklist&#39;;

const wcChecklist = r2wc(Checklist, { props: { items: &#34;json&#34; } });

customElements.define(&#34;r2w-checklist&#34;, wcChecklist);
</code></pre><h3><a href=https://vuejs.org/>Vue3</a></h3><blockquote><p>Polymer æ˜¯å¦ä¸€ä¸ªç”±è°·æ­ŒèµåŠ©çš„é¡¹ç›®ï¼Œäº‹å®ä¸Šä¹Ÿæ˜¯ Vue çš„ä¸€ä¸ªçµæ„Ÿæ¥æºã€‚Vue çš„ç»„ä»¶å¯ä»¥ç²—ç•¥çš„ç±»æ¯”äº Polymer çš„è‡ªå®šä¹‰å…ƒç´ ï¼Œå¹¶ä¸”ä¸¤è€…å…·æœ‰ç›¸ä¼¼çš„å¼€å‘é£æ ¼ã€‚æœ€å¤§çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒPolymer æ˜¯åŸºäºæœ€æ–°ç‰ˆçš„ Web Components æ ‡å‡†ä¹‹ä¸Šï¼Œå¹¶ä¸”éœ€è¦é‡é‡çº§çš„ polyfills æ¥å¸®åŠ©å·¥ä½œ (æ€§èƒ½ä¸‹é™)ï¼Œæµè§ˆå™¨æœ¬èº«å¹¶ä¸æ”¯æŒè¿™äº›åŠŸèƒ½ã€‚ç›¸æ¯”è€Œè¨€ï¼ŒVue åœ¨æ”¯æŒåˆ° IE9 çš„æƒ…å†µä¸‹å¹¶ä¸éœ€è¦ä¾èµ– polyfills æ¥å·¥ä½œã€‚<p>...<p>Vue implements a content distribution API inspired by the <a href=https://github.com/w3c/webcomponents/blob/gh-pages/proposals/Slots-Proposal.md>Web Components spec draft</a>, using the <code>&lt;slot&gt;</code> element to serve as distribution outlets for content.<p>-- vue2å®˜æ–¹æ–‡æ¡£</blockquote><p>æºè‡ª Vue 2.x æ—¶ä»£å¯¹ Web Components çš„å…³æ³¨ï¼ŒVue 3 æ›´è¿›ä¸€æ­¥ï¼Œ<strong>åŸç”Ÿæ”¯æŒäº†å°† Vue 3 ç»„ä»¶å¯¼å‡ºä¸º Web Components</strong>ï¼š<blockquote><p>Vue æä¾›äº†ä¸€ä¸ªå’Œå®šä¹‰ä¸€èˆ¬ Vue ç»„ä»¶å‡ ä¹å®Œå…¨ä¸€è‡´çš„ <a href=https://vuejs.org/api/general.html#definecustomelement><code>defineCustomElement</code></a> æ–¹æ³•æ¥æ”¯æŒåˆ›å»ºè‡ªå®šä¹‰å…ƒç´ ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶çš„å‚æ•°å’Œ <a href=https://vuejs.org/api/general.html#definecomponent><code>defineComponent</code></a> å®Œå…¨ç›¸åŒã€‚ä½†å®ƒä¼šè¿”å›ä¸€ä¸ªç»§æ‰¿è‡ª <code>HTMLElement</code> çš„è‡ªå®šä¹‰å…ƒç´ æ„é€ å™¨ï¼š<pre><code class="hljs language-perl code-block-extension-codeShowNum">
</code></pre><pre><code class="hljs language-javascript code-block-extension-codeShowNum">import { defineCustomElement } from &#39;vue&#39;

const MyVueElement = defineCustomElement({
  // è¿™é‡Œæ˜¯åŒå¹³å¸¸ä¸€æ ·çš„ Vue ç»„ä»¶é€‰é¡¹
  props: {},
  emits: {},
  template: `...`,

  // defineCustomElement ç‰¹æœ‰çš„ï¼šæ³¨å…¥è¿› shadow root çš„ CSS
  styles: [`/* inlined css */`]
})

// æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ 
// æ³¨å†Œä¹‹åï¼Œæ‰€æœ‰æ­¤é¡µé¢ä¸­çš„ `` æ ‡ç­¾
// éƒ½ä¼šè¢«å‡çº§
customElements.define(&#39;my-vue-element&#39;, MyVueElement)

// ä½ ä¹Ÿå¯ä»¥ç¼–ç¨‹å¼åœ°å®ä¾‹åŒ–å…ƒç´ ï¼š
// ï¼ˆå¿…é¡»åœ¨æ³¨å†Œä¹‹åï¼‰
document.body.appendChild(
  new MyVueElement({
    // åˆå§‹åŒ– propsï¼ˆå¯é€‰ï¼‰
  })
)
</code></pre><p>...<p>å®˜æ–¹çš„ SFC å·¥å…·é“¾æ”¯æŒä»¥â€œè‡ªå®šä¹‰å…ƒç´ æ¨¡å¼â€å¯¼å…¥ SFC (éœ€è¦ <code>@vitejs/plugin-vue@^1.4.0</code> æˆ– <code>vue-loader@^16.5.0</code>)ã€‚ä¸€ä¸ªä»¥è‡ªå®šä¹‰å…ƒç´ æ¨¡å¼åŠ è½½çš„ SFC å°†ä¼šå†…è”å…¶ <code>&lt;style&gt;</code> æ ‡ç­¾ä¸º CSS å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶æš´éœ²ä¸ºç»„ä»¶çš„ <code>styles</code> é€‰é¡¹ã€‚è¿™ä¼šè¢« <code>defineCustomElement</code> æå–ä½¿ç”¨ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶æ³¨å…¥åˆ°å…ƒç´ çš„ shadow root ä¸Šã€‚<p>è¦å¼€å¯è¿™ä¸ªæ¨¡å¼ï¼Œåªéœ€è¦å°†ä½ çš„ç»„ä»¶æ–‡ä»¶ä»¥ <code>.ce.vue</code> ç»“å°¾å³å¯ï¼š<pre><code class="hljs language-javascript code-block-extension-codeShowNum">import { defineCustomElement } from &#39;vue&#39;
import Example from &#39;./Example.ce.vue&#39;

console.log(Example.styles) // [&#34;/* å†…è” css */&#34;]

// è½¬æ¢ä¸ºè‡ªå®šä¹‰å…ƒç´ æ„é€ å™¨
const ExampleElement = defineCustomElement(Example)

// æ³¨å†Œ
customElements.define(&#39;my-example&#39;, ExampleElement)
</code></pre></blockquote><p>åœ¨ Vue 3 ä¸­ä½¿ç”¨å…¶ä»– Web Component åŒæ ·ç®€å•ï¼Œæ ¹æ®ç¼–è¯‘ç¯å¢ƒæ˜¯æµè§ˆå™¨ã€vite æˆ–æ˜¯ vue cli ç­‰ï¼Œè®¾ç½®å…¶ <code>isCustomElement</code> é…ç½®å‡½æ•°ä¸º <code>(tag) =&gt; tag.includes(&#39;-&#39;)</code> ååŸºæœ¬å°±èƒ½æ­£å¸¸ä½¿ç”¨äº†ï¼›è¯¦è§<a href=https://cn.vuejs.org/guide/extras/web-components.html#using-custom-elements-in-vue>å®˜æ–¹æ–‡æ¡£</a>ã€‚<h3><a href=https://v2.cn.vuejs.org/>Vue 2</a></h3><p>Vue 2 ä¸­å¹¶ä¸å…·å¤‡ Vue 3 ä¸­ defineCustomElement é‚£æ ·çš„æ–¹æ³•ã€‚<h4>webpack</h4><p>å¯¹äºå¤§éƒ¨åˆ†åŸºäºåŸç”Ÿ webpack çš„ Vue 2 é¡¹ç›®ï¼Œå¯ä»¥ç”¨å¼€æºæ’ä»¶ <a href=https://github.com/karol-f/vue-custom-element>vue-custom-element</a> è¾¾åˆ°å’Œ defineCustomElement ç±»ä¼¼çš„æ•ˆæœï¼Œå¦‚ï¼š<pre><code class="hljs language-ini code-block-extension-codeShowNum">Vue.customElement(&#39;widget-vue&#39;, MyVueComponent, {
  shadow: true,
  beforeCreateVueInstance(root) {
    const rootNode = root.el.getRootNode();

    if (rootNode instanceof ShadowRoot) {
      root.shadowRoot = rootNode;
    } else {
      root.shadowRoot = document.head;
    }
    return root;
  },
});
</code></pre><h4>Vue CLI</h4><p>è€Œåœ¨ç”± Vue CLI æ„å»ºçš„ Vue é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸ºæ„å»ºå‘½ä»¤æŒ‡å®š <a href=https://cli.vuejs.org/zh/guide/build-targets.html#web-components-%E7%BB%84%E4%BB%B6><code>--target wc</code></a> å‚æ•°ï¼Œä»è€Œå°†ä¸€ä¸ªå•ç‹¬çš„å…¥å£æ„å»ºä¸ºä¸€ä¸ª Web Components ç»„ä»¶ï¼š<pre><code class="hljs language-css code-block-extension-codeShowNum">vue-cli-service build --target wc --name my-element [entry]
</code></pre><ul><li><code>entry</code> åº”è¯¥æ˜¯ä¸€ä¸ª *.vue æ–‡ä»¶ã€‚Vue CLI å°†ä¼šæŠŠè¿™ä¸ªç»„ä»¶è‡ªåŠ¨åŒ…è£¹å¹¶æ³¨å†Œä¸º Web Components ç»„ä»¶ï¼Œæ— éœ€åœ¨ main.js é‡Œè‡ªè¡Œæ³¨å†Œ<li>åœ¨ Web Components æ¨¡å¼ä¸­ï¼ŒVue æ˜¯å¤–ç½®çš„ã€‚è¿™æ„å‘³ç€åŒ…ä¸­ä¸ä¼šæœ‰ Vueï¼Œå³ä¾¿ä½ åœ¨ä»£ç ä¸­å¯¼å…¥äº† Vueã€‚è¿™é‡Œçš„åŒ…ä¼šå‡è®¾åœ¨é¡µé¢ä¸­å·²ç»æœ‰ä¸€ä¸ªå¯ç”¨çš„å…¨å±€å˜é‡ Vue<li>è¯¥æ„å»ºå°†ä¼šäº§ç”Ÿä¸€ä¸ªå•ç‹¬çš„ JavaScript æ–‡ä»¶ (åŠå…¶å‹ç¼©åçš„ç‰ˆæœ¬) å°†æ‰€æœ‰çš„ä¸œè¥¿éƒ½å†…è”èµ·æ¥<li>å½“è¿™ä¸ªè„šæœ¬è¢«å¼•å…¥ç½‘é¡µæ—¶ï¼Œä¼šæ³¨å†Œè‡ªå®šä¹‰ç»„ä»¶ ï¼Œå…¶ä½¿ç”¨ <a href="https://link.juejin.cn/?target=">@vue/web-component-wrapper</a> åŒ…è£¹ç›®æ ‡ Vue ç»„ä»¶ï¼Œå¹¶è‡ªåŠ¨ä»£ç†å±æ€§ã€ç‰¹æ€§ã€äº‹ä»¶å’Œæ’æ§½<li>ä¹Ÿå¯ä»¥è®¾ç½®æ„å»ºå‘½ä»¤æ‰“åŒ…å¤šä¸ªç»„ä»¶æˆ–å¼‚æ­¥ç»„ä»¶</ul><pre><code class="hljs language-xml code-block-extension-codeShowNum">




</code></pre><h2>ğŸŒ°å®ä¾‹ï¼šç”¨å¼‚æ„ç³»ç»Ÿå…±å»º web components</h2><p><a href=https://gitee.com/tonylua/web-component-test1/tree/master><img src=https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/4ef48238.webp> ç‚¹å‡»æŸ¥çœ‹</a><h2>æ€»ç»“</h2><p>æ­£å¦‚ä»¥ Flash ä¸ºä»£è¡¨çš„ RIA æŠ€æœ¯æµªæ½®æå¤§åœ°åˆºæ¿€äº†æµè§ˆå™¨å‚å•†ï¼Œä»è€ŒåŠ é€Ÿäº†æµè§ˆå™¨çš„è¿›æ­¥å¹¶å‚¬ç”Ÿäº† ES5/ES6 çš„è½åœ°ï¼›åŒæ ·ï¼ŒAngular/React/Vue ç­‰å‰ç«¯ç»„ä»¶åŒ–å¼€å‘æ¡†æ¶çš„æ™®åŠï¼Œä¹Ÿè®©åŸç”Ÿçš„ Web Components æ ‡å‡†ä¸æ–­å‘å±•ã€‚<p>Web Components æ­é…çš„ shadow DOM å°è£…ç­‰å®ç”¨ç‰¹æ€§ï¼Œè®©ä¸€ç›´å›°æ‰°å¼€å‘è€…ä»¬çš„æ ·å¼å±€éƒ¨åŒ–å’Œäº‹ä»¶éš”ç¦»ç­‰é—®é¢˜è¿åˆƒè€Œè§£ã€‚<p>éšç€ç°ä»£æµè§ˆå™¨å…¼å®¹æ€§çš„ä¸æ–­æ”¹å–„å’Œå„ç§å¼€å‘æ¡†æ¶å¯¹ Web Components çš„ä¸»åŠ¨æ‹¥æŠ±ï¼Œä¹ŸåŠ¿å¿…ä¼šåœ¨ä¸ä¹…çš„å°†æ¥æ‰“ç ´å‰ç«¯å¼€å‘æŠ€æœ¯æ ˆä¹‹é—´çš„å£å’ï¼Œè®©æ•´ä¸ªç¤¾åŒºæ²‰æ·€çš„æœåŠ¡å’Œèƒ½åŠ›è¿æ¥ä¸€æ¬¡å¤§çš„æ•´åˆã€‚<h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href=http://w3c-html-ig-zh.github.io/webcomponents/spec-zh/shadow/>w3c-html-ig-zh.github.io/webcomponenâ€¦</a><li><a href=https://javascript.info/webcomponents-intro>javascript.info/webcomponenâ€¦</a><li><a href=https://www.webcomponents.org/introduction>www.webcomponents.org/introductioâ€¦</a><li><a href=https://juejin.cn/post/7072715334519619598>juejin.cn/post/707271â€¦</a><li><a href=https://juejin.cn/post/7148974524795453476>juejin.cn/post/714897â€¦</a><li><a href=https://juejin.cn/post/7107856163361783816>juejin.cn/post/710785â€¦</a><li><a href=https://www.zhihu.com/question/321832109>www.zhihu.com/question/32â€¦</a><li><a href=https://juejin.cn/post/7181088227531915322>juejin.cn/post/718108â€¦</a><li><a href=https://www.jitendrazaa.com/blog/salesforce/introduction-to-html-web-components/>www.jitendrazaa.com/blog/salesfâ€¦</a><li><a href=https://juejin.cn/post/7168630364246638606>juejin.cn/post/716863â€¦</a><li><a href=https://juejin.cn/post/6976557762377416718>juejin.cn/post/697655â€¦</a><li><a href=https://cn.vuejs.org/guide/extras/web-components.html>cn.vuejs.org/guide/extraâ€¦</a><li><a href=https://web.dev/custom-elements-best-practices/>web.dev/custom-elemâ€¦</a><li><a href=https://github.com/stcruy/building-a-reusable-vue-web-component>github.com/stcruy/builâ€¦</a><li><a href=https://www.oreilly.com/library/view/modern-javascript/9781491971420/ch05.html>www.oreilly.com/library/vieâ€¦</a><li><a href=https://developer.mozilla.org/zh-CN/docs/Web/API/Web_components>developer.mozilla.org/zh-CN/docs/â€¦</a><li><a href=https://deepinout.com/css/css-questions/417_css_what_is_the_different_between_host_host_hostcontext_selectors.html>deepinout.com/css/css-queâ€¦</a><li><a href=https://www.zhangxinxu.com/wordpress/2021/02/css-part-shadow-dom/>www.zhangxinxu.com/wordpress/2â€¦</a><li><a href=https://juejin.cn/post/6923957212075261966>juejin.cn/post/692395â€¦</a><li><a href=https://web.dev/custom-elements-best-practices/>web.dev/custom-elemâ€¦</a><li><a href=https://www.abeautifulsite.net/tags/web%20components/>www.abeautifulsite.net/tags/web%20â€¦</a><li><a href=https://juejin.cn/post/7010595352550047752>juejin.cn/post/701059â€¦</a><li><a href=https://dev.to/nurlan_tl/tips-to-create-web-components-using-vue-3-ts-vite-3a7a>dev.to/nurlan_tl/tâ€¦</a><li><a href=https://itnext.io/react-and-web-components-3e0fca98a593>itnext.io/react-and-wâ€¦</a><li><a href=https://www.bitovi.com/blog/how-to-create-a-web-component-with-create-react-app>www.bitovi.com/blog/how-toâ€¦</a></ul></div></main>
<hr>
<footer>
        <label>åŸç½‘å€: <a href="https://juejin.cn/post/7277371354453131322" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">è®¿é—®</a></label><br/>
        <label>åˆ›å»ºæ—¶é—´: 2023-09-12 08:57:38</label><br/>
        <br/>
        
      </footer>
<link rel=stylesheet href=https://cp-bkt1.oss-cn-hangzhou.aliyuncs.com/cdn/prism.css>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css>
<script src=https://cp-bkt1.oss-cn-hangzhou.aliyuncs.com/cdn/prism.js></script>
</body>
</html>